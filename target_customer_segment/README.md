# Определение целевого сегмента клиентов для таргетированной рекламы

## Введение

**Заказчик:** ООО «ПЭК»

**Цель:** Определить целевой сегмент клиентов, наиболее эффективный для таргетированной рекламы через email рассылки.

**Задача от заказчика:** Определить ключевые метрики для оценки эффективности, составить клиентский портрет по существующему набору характеристик, выделить ключевой сегмент по эффективности.

## Набор данных
Данные предоставлены заказчиком и представляют собой 3 датасета:
- feedback.csv - содержит данные о реакции контрагента на отправляемую ПЭК рассылку. Рассылка - группа маркетинговых компаний проводимых с 1 января по 31 декабря 2023 года.
- behavior_2023.csv - содержит данные с описанием поведения контрагентов ПЭК за 2023 год.
- behavior_2024.csv - содержит данные с описанием поведения контрагентов ПЭК за 2024 год с января по март включительно.

## Разделы проекта
1. [Изучение и предобработка данных](https://github.com/Bjorik23/mipt_datatons/blob/main/target_customer_segment/preprocessed/preprocessing.ipynb)
2. [Анализ и преобразование данных для обучения моделей](https://github.com/Bjorik23/mipt_datatons/blob/2aeba62bde0779a5aae4be6eb05c55d1c45453bb/target_customer_segment/feature_selection/select_feature.ipynb)
3. [Обучение моделей (часть 1)](https://github.com/Bjorik23/mipt_datatons/blob/2aeba62bde0779a5aae4be6eb05c55d1c45453bb/target_customer_segment/ml_boost/ml_boost.ipynb)

## Выводы по подготовке и анализу данных

Сделано следующее:
1. Загрузка, подготовка и предобработка данных.
3. Выполнен исследвательский и статистический анализ данных.
3. Рассмотрена класстеризация целевых признаков.
4. Выполнен отбор признаков с использованием информационного критерия Джинни
5. Созданы эмбендинги признаков

## Выводы по обучению моделей

1. Обучены модели градиентного бустинга на эмбендингах признаков
2. Обучены модели градиентного бустинга на отобранных признаках

 - 2.1. Результаты обучения моделей регрессии

<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>LightGBM</th>
      <th>CatBoost</th>
      <th>XGBoost</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>MSE</th>
      <td>0.0044</td>
      <td>0.0035</td>
      <td>0.0010</td>
    </tr>
    <tr>
      <th>R2-score</th>
      <td>89.7%</td>
      <td>91.7%</td>
      <td>97.5%</td>
    </tr>
    <tr>
      <th>Time</th>
      <td>2.57 сек</td>
      <td>62.07 сек</td>
      <td>257.07 сек</td>
    </tr>
  </tbody>
</table>
</div>

> Как видно из таблицы лучший результат из данных моделей показывает XGBoost, но также у этой модели уходит в разы больше времени на обучение, чем у остальных.
> В целом можно сделать вывод, что все 3 модели отлично справляются с предсказанием вероятности того, что клиент откроет ссылку в письме, о чем нам говорит метрика r2 > 80%.


 - 2.2. Результаты обучения моделей классификации

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CatBoost</th>
      <th>LightGBM</th>
      <th>XGBoost</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>F1-score</th>
      <td>0.933</td>
      <td>0.921</td>
      <td>0.971</td>
    </tr>
    <tr>
      <th>Accuracy</th>
      <td>0.973</td>
      <td>0.966</td>
      <td>0.988</td>
    </tr>
    <tr>
      <th>Precision</th>
      <td>0.943</td>
      <td>0.876</td>
      <td>0.956</td>
    </tr>
    <tr>
      <th>Recall</th>
      <td>0.923</td>
      <td>0.971</td>
      <td>0.986</td>
    </tr>
    <tr>
      <th>Time</th>
      <td>61.08 сек</td>
      <td>5.73 сек</td>
      <td>129.15 сек</td>
    </tr>
  </tbody>
</table>
</div>

> Все построенные модели классификации показали качественные результаты, лучше всех справилась модель XGBoost, но аналогично с регрессией на нее уходит больше всего времени для обучения.

> По итогам данной работы было обучено 6 моделей, 3 на классификацию и 3 на регрессию, полученные метрики качества позволяют внедрять их в реальные задачи R2-score > 80% и F1-score > 0.8. 

> Вариант регрессии является более гибким, отдел маркетинга может самостоятельно выбрать границу вероятности, на которую стоит опираться при рассылке рекламных предложений. Вариант же классификации также имеет в себе некую гибкость, можно изменить порог отнесения тех или иных данных к 0-му ли 1-му классу, что представлено в ноутбуке select_features.ipynb

## Требования

Проект использует следующие библиотеки Python, которые необходимо установить:

```bash
pandas 2.2.2
numpy 1.26.4
matplotlib 3.9.0
seaborn 0.13.2
scikit-learn 1.5.0
torch 2.3.0
statsmodels 0.14.2
tqdm 4.66.4
xgboost 2.0.3
catboost 1.2.5
lightgbm 4.3.0
optuna 3.6.1
```

Установите их, используя pip install или conda install в зависимости от вашего средства управления пакетами.

## Установка

Чтобы самостоятельно обучить модели, выполните следующие шаги:

1. Клонирование репозитория:
   ```bash
   git clone [https://github.com/Bjorik23/mipt_datatons]
   ```
2. Установите необходимые зависимости:
   ```bash
   pip install -r requirements.txt
   ```
3. Запустите Jupyter Notebooks:
    ```bash
   target_customer_segment/preprocessed/preprocessing.ipynb
   ```
   ```bash
   target_customer_segment/feature_selection/select_feature.ipynb
   ```
   ```bash
   target_customer_segment/ml_boost/ml_boost.ipynb
   ```


## Лицензия

Этот проект доступен для использования только ООО "ПЭК".

## Авторы

Проект был разработан следующими участниками:

- **Karina Akchurina** [GitHub](https://github.com/Karina1605) `предварительная обработка данных, разведовательный анализ данных`
- **Elena Almaeva** [GitHub](https://github.com/Cu-hedgehog) `построение моделей машинного обучения с использованием Optuna для подбора параметров (6 моделей). Валидация качества модели`
- **Mikhail Kuzmenkov** [GitHub](https://github.com/MikhailKuzm) `анализ данных, подготовка данных для обучения моделей`
- **Olga Redchenko** [GitHub](https://github.com/OlgaRedchenko) `исследование в выбранной предметной области, составление плана работы, подготовка к защите проекта`
- **Bair Vambuev** [GitHub](https://github.com/Bjorik23) `координирование работы команды, создание проекта в репозитории, составление плана работы и подготовка к защите проекта`
- **Dmitry Zaitsev** [GitHub](https://github.com/DimaZaytsev) `построение моделей машинного обучения с использованием Optuna для подбора параметров (6 моделей). Валидация качества модели`
